name: Test
on:
  push:
    branches:
    - develop
    paths:
    - '.github/workflows/Test.yml'
jobs:
  build:
    runs-on: windows-latest
    env: 
      DBLP_VER: '2020-08-01'
    steps:
    - uses: actions/cache@v2
      id: cache-qt
      with:
        path: ../Qt
        key: ${{ runner.os }}/Qt/5.15.0
    - uses: jurplel/install-qt-action@v2
      with:
        version: 5.15.0
        cached: ${{ steps.cache-qt.outputs.cache-hit }}
    - uses: actions/checkout@v2
    - name: cache dblp data
      id: cache-dblp
      uses: actions/cache@v2
      with:
        path: dblp-${{ env.DBLP_VER }}.xml
        key: ${{ runner.os }}/dblp-${{ env.DBLP_VER }}.xml
    - uses: actions/setup-python@v2
      if: steps.cache-dblp.outputs.cache-hit != 'true'
    - uses: actions/checkout@v2
      if: steps.cache-dblp.outputs.cache-hit != 'true'
    - name: setup dblp data
      if: steps.cache-dblp.outputs.cache-hit != 'true'
      shell: pwsh
      run: |
        pip3 install requests
        pip3 install clint
        python .\scripts\download.py ${{ env.DBLP_VER }}
        7z x dblp-${{ env.DBLP_VER }}.xml.gz